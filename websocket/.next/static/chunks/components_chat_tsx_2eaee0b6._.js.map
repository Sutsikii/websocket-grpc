{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/mecha/workflow/websocket-grpc/components/chat.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState, KeyboardEvent as ReactKeyboardEvent, useRef } from 'react'\r\nimport { io } from 'socket.io-client'\r\n\r\nconst socket = io('http://localhost:3001')\r\n\r\nexport default function ChatPage() {\r\n  const [message, setMessage] = useState('')\r\n  const [messages, setMessages] = useState<string[]>([])\r\n  const messagesEndRef = useRef<HTMLDivElement>(null)\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: \"smooth\" })\r\n  }\r\n\r\n  useEffect(() => {\r\n    socket.on('chat message', (msg) => {\r\n      setMessages((prev) => [...prev, msg])\r\n    })\r\n\r\n    return () => {\r\n      socket.off('chat message')\r\n    }\r\n  }, [])\r\n\r\n  useEffect(() => {\r\n    scrollToBottom()\r\n  }, [messages])\r\n\r\n  const sendMessage = () => {\r\n    if (message.trim()) {\r\n      socket.emit('chat message', message)\r\n      setMessage('')\r\n    }\r\n  }\r\n\r\n  const handleKeyDown = (event: ReactKeyboardEvent<HTMLInputElement>) => {\r\n    if (event.key === 'Enter' && !event.shiftKey) {\r\n      event.preventDefault()\r\n      sendMessage()\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"p-4 max-w-xl mx-auto\">\r\n      <div className=\"text-black p-4 h-64 overflow-y-scroll mb-4 bg-gray-100 rounded\">\r\n        {messages.map((msg, i) => (\r\n          <div key={i} className=\"mb-2 p-2\">{msg}</div>\r\n        ))}\r\n        <div ref={messagesEndRef} />\r\n      </div>\r\n      <div className=\"flex gap-2\">\r\n        <input\r\n          type=\"text\"\r\n          value={message}\r\n          onChange={(e) => setMessage(e.target.value)}\r\n          onKeyDown={handleKeyDown}\r\n          className=\"border p-2 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n          placeholder=\"Ã‰cris ton message...\"\r\n        />\r\n        <button \r\n          onClick={sendMessage} \r\n          className=\"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600 transition-colors\"\r\n        >\r\n          Envoyer\r\n        </button>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;;;AAHA;;;AAKA,MAAM,SAAS,CAAA,GAAA,kLAAA,CAAA,KAAE,AAAD,EAAE;AAEH,SAAS;;IACtB,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IACrD,MAAM,iBAAiB,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAkB;IAE9C,MAAM,iBAAiB;QACrB,eAAe,OAAO,EAAE,eAAe;YAAE,UAAU;QAAS;IAC9D;IAEA,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR,OAAO,EAAE,CAAC;sCAAgB,CAAC;oBACzB;8CAAY,CAAC,OAAS;mCAAI;gCAAM;6BAAI;;gBACtC;;YAEA;sCAAO;oBACL,OAAO,GAAG,CAAC;gBACb;;QACF;6BAAG,EAAE;IAEL,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;8BAAE;YACR;QACF;6BAAG;QAAC;KAAS;IAEb,MAAM,cAAc;QAClB,IAAI,QAAQ,IAAI,IAAI;YAClB,OAAO,IAAI,CAAC,gBAAgB;YAC5B,WAAW;QACb;IACF;IAEA,MAAM,gBAAgB,CAAC;QACrB,IAAI,MAAM,GAAG,KAAK,WAAW,CAAC,MAAM,QAAQ,EAAE;YAC5C,MAAM,cAAc;YACpB;QACF;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;oBACZ,SAAS,GAAG,CAAC,CAAC,KAAK,kBAClB,6LAAC;4BAAY,WAAU;sCAAY;2BAAzB;;;;;kCAEZ,6LAAC;wBAAI,KAAK;;;;;;;;;;;;0BAEZ,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,MAAK;wBACL,OAAO;wBACP,UAAU,CAAC,IAAM,WAAW,EAAE,MAAM,CAAC,KAAK;wBAC1C,WAAW;wBACX,WAAU;wBACV,aAAY;;;;;;kCAEd,6LAAC;wBACC,SAAS;wBACT,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT;GA/DwB;KAAA","debugId":null}}]
}